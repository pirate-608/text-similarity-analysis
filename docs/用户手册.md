# 用户手册

## 环境准备
- 需要 gcc/clang（C99）与 make。
- 依赖 POSIX `dirent.h`：Windows 建议使用 MSYS2/MinGW 或 WSL 终端。
- 文档需为 UTF-8 `.txt` 文件。

## 构建
```
make
```
产物：`build/bin/similarity`，测试可执行位于 `build/bin/test_*`。

## 运行方式
### 交互模式（默认）
```
./build/bin/similarity
```
- 菜单支持：加载目录、生成矩阵、查看 Top 相似对、按阈值筛选、热力图、统计信息。

### 批处理模式
```
./build/bin/similarity -d ./data -o similarity.csv -s stopwords.txt
```
- `-d <目录>`：必填，指向包含 `.txt` 的目录。
- `-o <文件>`：可选，输出相似度矩阵 CSV，默认 `similarity_matrix.csv`。
- `-s <文件>`：可选，附加停用词列表。
- 输出：Top10 相似对打印到终端，矩阵写入 CSV。

## 输入规范
- 仅处理扩展名 `.txt` 的普通文件；其他文件会被跳过。
- 默认分词以字母和 `'` 组成单词，其余字符视为分隔符；处理前转换为小写。
- 停用词：内置常见英文停用词，若指定 `-s` 则附加用户自定义列表。

## 输出与查看
- CSV：行列均为文件名，单元格为相似度（对角线 1.0）。
- Top 相似对：显示相似度最高的文档组合及数值。
- 热力图：终端 ASCII 形式，默认展示前 20×20 子矩阵。
- 统计：总词数、唯一词数、最长/最短文档等。

## 故障排查
- 编译找不到 `dirent.h`：在 Windows 改用 MSYS2/MinGW 或 WSL；Linux/macOS 默认提供。
- 运行无输出：确认目录下有 `.txt` 文件且非空。
- 相似度始终为 0：检查停用词是否过多、文本是否为空或完全不同；必要时移除停用词文件再试。

## 典型流程
1) 准备 `samples/mini` 中的少量 `.txt` 示例，执行批处理模式验证。
2) 扩大到 `samples/small` 或 `samples/medium`，评估运行时间与矩阵大小。
3) 进入交互模式，使用热力图与筛选功能查看局部相似度分布。
